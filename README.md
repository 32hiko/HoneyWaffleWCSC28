# HoneyWaffleWCSC28

HoneyWaffleは第28回世界コンピュータ将棋選手権で決勝リーグに進出し、決勝リーグ最下位の8位という成績でした。  
エンジン、定跡ファイル、評価関数のセットを公開します。  

## エンジン、定跡ファイル、評価関数のセット

https://drive.google.com/file/d/1eczNX5zMiAKwmBg-IMj25Fq2vFYBE0lJ/view?usp=sharing

エンジンと定跡ファイル（user_book2.db）、評価関数のセットです。
Windows向けのAVX2対応版とSSE42版を同梱しています。  
※わかりやすさのためにエンジンのファイル名をYaneuraOu～から変更しています。

### エンジンの登録

HoneyWaffle_WCSC28_AVX2.exeを選択して登録してください。何かエラーが発生した場合は、HoneyWaffle_WCSC28_sse42.exeを試してみてください。
なおどちらもエラーとなる場合、お使いのPCでは起動ができないと思われます。

### エンジンの設定（例）

このあたりは通常のやねうら王と同じように設定してください。

![エンジンの設定](https://github.com/32hiko/HoneyWaffleWCSC28/blob/master/engine_ss_2018-05-10%2000.20.02.png)

### 定跡ファイルの設定

以下のようにuser_book2.dbを選択し、BookMovesは80、その他のBookなんとかは全部0にしてください。

![定跡ファイルの設定](https://github.com/32hiko/HoneyWaffleWCSC28/blob/master/book_ss_2018-05-10%2000.05.00.png)

-----

## やねうら王エンジンの改変部分について

玉を堅く囲うために、KPPTの評価の中で、美濃囲いにボーナスをつけています。いわゆる落とし穴です。  
玉を美濃囲いの位置（先手なら２八、後手なら８二）に誘導するだけで、自然と美濃囲いやそこから発展させての銀冠に組みます。  
(evaluate_kppt.cppの610行目、710行目あたり)  
https://github.com/32hiko/HoneyWaffleWCSC28/blob/d7975c367bd1bdd8e8accc4d607232c25d224a4a/evaluate_kppt.cpp#L610  
当初は振り飛車穴熊にさらにボーナスをつけたりしていましたが、穴熊に潜ってもすぐに囲いで殴り始めたり等、バランス面で不満があり、現状の実装になりました。

## 評価関数

AperySDT5の評価関数をベースに、HoneyWaffleSDT5の振り飛車「狂」評価関数をほんのわずかだけ混ぜました。  
※純粋に振り飛車を評価するものではなく、あくまで定跡やエンジンとの組み合わせで振り飛車を指す、というものなので過度の期待は禁物です。

## 定跡ファイル（やねうら王形式）

https://github.com/32hiko/HoneyWaffleWCSC28/blob/master/user_book2.db

SDT5版の定跡をベースにしました。当然、振り飛車定跡です。

やねうら王にApery評価関数を搭載したものを相手に、定跡なし or 「まふ定跡横歩取り(SDT5で平成将棋合戦ぽんぽこさんが公開したもの)」をのせ、1手60秒6スレッド、投了値500で対戦。（これはうちの環境で2億ノード程度になります。）  
80手までの手順のうち、振り飛車が有利または互角の部分だけを目検で吟味して採用しています。  
※私がアマチュア級位者レベルなのに、そういうことをやっているので、変な手順が混入している可能性は大いにあります。  
間違えて居飛車にならないよう、居飛車側の手は含んでいません。純粋に対局目的の定跡で、人間が読むことは想定していません。  
